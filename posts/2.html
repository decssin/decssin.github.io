<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>@jiwon.blog</title>

	<link rel="icon" type="image/png" href="../favicon.ico">
	<link rel="stylesheet" href="../index.css" />

	<noscript><div id="noscript" class="display-flex">Your browser does not support JavaScript!</div></noscript>
</head>
<body>
	<div id="wrap">
		<div class="open-menu display-flex position-fixed top-0 left-0" style="opacity:0;visibility:hidden;">
			<ul class="menu-list">
				<li><span class="cursor-pointer">HOME</span></li>
				<li><span class="cursor-pointer">WEB DESIGN</span></li>
				<li><span class="cursor-pointer">ABOUT ME</span></li>
				<li><br/></li>
				<li><span class="cursor-pointer">KOR/ENG</span></li>
				<li><span class="cursor-pointer" onclick="dayAndNight()">DAY/NIGHT</span></li>
			</ul>
		</div>

		<div id="header" class="width-100 position-fixed top-0 left-0 cursor-pointer" onclick="toTheTop()">
			<div class="header-wrap display-flex width-100 height-100 position-relative margin-0-auto">
				<div class="menu-button display-flex cursor-pointer" onclick="toggleMenu()">
					<div class="line width-100"></div>
					<div class="line width-100"></div>
					<div class="line width-100"></div>
				</div>
				<div class="title cursor-pointer" onclick="goHome()">@jiwon.blog</div>
				<div class="search-posts position-relative"></div>
			</div>
		</div>

		<div id="content">
            <div class="title">Apache 웹 서버 설정</div>
            <div class="info">2021. 01. 20, 21:30:00 by Jiwon Min</br>Wed Jan 20 2021 21:30:00 GMT+0900 (KST)</div>

            <div class="explain">
				
Apache 웹서버에서 오버라이드 설정을 허용했다면, .htaccess 파일을 사용해 웹서버 설정 파일을 오버라이드 할 수 있습니다. 
Apache 웹서버 설정에는 다양한 옵션을 변경할 수 있도록 제공하고 있습니다. 
서버 정보를 표시하거나, https 접속을 위한 설정을 추가하거나 특정 user-agent의 접근을 차단하는 등의 옵션이 있습니다.

<br/>
<br/>

<h3>디렉토리 설정</h3>


특정 폴더로 접속하는 URL 에서는 보안을 위해서 서버 경로를 제외해서 접근할 수 있습니다. 
아래 htaccess 설정은 Storage 하위 폴더의 경로를 작성할 때, Storage 폴더를 직접 작성하지 않아도 됩니다.

<br/>
<br/>

<pre>
RewriteCond %{REQUEST_URI} ^/(artwork|calculate|storage|save|media)/
RewriteRule ^(.*)$ Storage/$1 [L]
</pre>


위의 내용을 응용하면, 모든 접속 URL 을 하나의 파일에서 처리 할 수 있으므로, 권한 설정이나 기타 공통적으로 처리해야 하는 부분을 쉽게 해결할 수 있습니다.

<br/>
<br/>

<pre>
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php?/$1 [L]
</pre>


특정 폴더로 접속하도록 설정하는 것도 가능합니다.

<br/>
<br/>

<pre>
# view 폴더 경로 숨기기 (모든 URL 이 /view/를 거칩니다.)
RewriteEngine on
RewriteCond %{REQUEST_URI} !^/(view)
RewriteRule (.*) /view/$1
</pre>

<h3>파일접근 설정</h3>

특정 파일에 대한 URL 로의 접근을 차단해야 하는 경우가 있습니다. 
중요한 설정 파일이나, 특정 스크립트가 실행되는 파일은 URL 로 접근하는 것을 막아야 할 필요가 있습니다. 
다음 htaccess 설정은 서버에서 URL 접근을 차단해줍니다.

<br/>
<br/>

<pre>
# 지정한 모든 파일은 접근 금지됩니다.
&lt;Files *.config.php&gt;
order allow,deny
deny from all
&lt;/Files&gt;

# .htaccess 파일 자체를 보호합니다.
&lt;Files ~ "^.*\.([Hh][Tt])"&gt;
Order allow,deny
Deny from all
Satisfy all
&lt;/Files&gt;
</pre>

<h3>PHP 설정값 변경</h3>

아파치의 httpd.conf 파일에서 htaccess 에 대한 설정 여부를 허용하면, php 설정 값도 변경 할 수 있습니다. 
이 때, 서버의 재실행이 불필요 하기 때문에, 유연한 제어가 가능합니다.


<br/>
<br/>

<pre>
# php.ini 설정값 변경
php_value upload_max_filesize           1024M
php_value post_max_size                 1024M

# php.ini 중, 에러 처리
# 404 Not Found (can't find file)
ErrorDocument 404 "/Resource/err/404.php"
# 403 Forbidden (no permission)
ErrorDocument 403 "/Resource/err/403.php"
# 500 Internal Server (program error)
ErrorDocument 500 "/Resource/err/500.php"
</pre>

<h3>그 외 설정</h3>

그 외에 htaccess 파일에서 설정 가능한 유용한 값들을 살펴봅니다.

<br/>
<br/>

<pre>
# URL 을 통해서 폴더로 접속했을 경우, 폴더 구조가 보이는 것을 막아줍니다.
Options All -Indexes

# 보안을 위해서 서버 정보를 표시하지 않습니다.
ServerSignature Off

# 기본 인코딩 값을 지정합니다.
AddDefaultCharset utf-8
AddCharset utf-8 .html .css .js .xml .json .rss .php .jsonp

# .php 확장자를 없애줍니다.
Options +MultiViews
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L]
</pre>


PHP에서 파일 제어 중에 서버로 업로드 안되는 경우, 권한을 확인합니다. 아파치의 기본 사용자는 nobody 또는 daemon 입니다. 
그렇기 때문에, 서버에서 루트 권한이 아니라면 파일 제어가 되지 않을 수 있습니다.
            </div>

			<div id="footer" class="display-flex position-absolute bottom-0 left-0">
				<div class="rights">&copy; 2021 <a href="javascript:void(0)" title="Jiwon Min">Jiwon Min</a>. All rights reserved.</div>
				<div class="design">Designed by <a href="javascript:void(0)" title="Jiwon Min">Jiwon Min</a>.</div>
			</div>
		</div>
	</div>

	<script src="../index.js" type="text/javascript"></script>
</body>
</html>